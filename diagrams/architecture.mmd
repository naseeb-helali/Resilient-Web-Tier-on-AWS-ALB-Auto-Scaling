flowchart LR
  %% === External ===
  subgraph Internet
    U[Users]
  end

  %% === Public Tier (L7) ===
  subgraph VPC
    direction LR

    subgraph Public_Subnets_(AZ-a/b)
      ALB[(Application Load Balancer)]
      ALB_NOTE[[Listeners: 443/HTTPS<br/>Rules: forward/redirect/fixed-response<br/>TLS: ACM + SNI (termination)<br/>Cross-Zone: enabled (default)]]:::warn
      ALB -.-> ALB_NOTE
    end

    %% === Private Tier (Compute) ===
    subgraph Private_Subnets_(AZ-a/b)
      ASG[(Auto Scaling Group)]
      TG[(Target Group - HTTP:80)]
      TG_NOTE[[Health check: GET /health<br/>Expect: 200-399<br/>Deregistration delay: 300s]]:::warn
      TG -.-> TG_NOTE
    end
  end

  %% === Data/Observability (abstracted) ===
  subgraph Observability_(Design)
    CW[(CloudWatch Metrics/Alarms)]
  end

  %% === Traffic Flow ===
  U -->|HTTPS 443| ALB -->|forward| TG -->|HTTP 80| ASG
  ASG -.-> CW
  ALB -.-> CW

  %% === Security Boundaries ===
  classDef bndry fill:#fff,stroke:#999,stroke-dasharray: 4 3;
  classDef sg fill:#eef6ff,stroke:#3b82f6,color:#111;
  classDef warn fill:#fff7ed,stroke:#fb923c,color:#111;

  %% Security Notes
  ALB:::sg
  TG:::sg
  ASG:::sg

  %% Legend
  subgraph Legend
    L1[[L7: ALB]]
    L2[[Compute Pool: ASG]]
    L3[[TG: Routing + Health]]
    L4[(Metrics/Alarms)]
  end
